\documentclass[final]{beamer}

% ====================
% Packages
% ====================

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[size=a2,scale=1.0]{beamerposter}
\usetheme{gemini}
\usecolortheme{gemini}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.14}
\usepackage{anyfontsize}

% ====================
% Lengths
% ====================

% If you have N columns, choose \sepwidth and \colwidth such that
% (N+1)*\sepwidth + N*\colwidth = \paperwidth
\newlength{\sepwidth}
\newlength{\colwidth}
\setlength{\sepwidth}{0.025\paperwidth}
\setlength{\colwidth}{0.3\paperwidth}
\newcounter{row}
\newcounter{col}
\newcounter{rowa}
\newcounter{cola}


\newcommand{\separatorcolumn}{\begin{column}{\sepwidth}\end{column}}

% ====================
% Title
% ====================

\title{Sudoku is Hard}

\author{Eve Routledge}

\institute[shortinst]{Durham University}

% ====================
% Footer (optional)
% ====================

\footercontent{
  \href{https://www.example.com}{https://www.example.com} \hfill
  \href{mailto:alyssa.p.hacker@example.com}{eve.routledge@durham.ac.uk}}
% (can be left out to remove footer)

% ====================
% Logo (optional)
% ====================

% use this to include logos on the left and/or right side of the header:
\logoleft{\includegraphics[height=4cm]{DurhamUniversityLogo_WHITE.png}}

% ====================
% Sudoku
% ====================
\newcommand\setrow[9]{
  \setcounter{col}{1}
  \foreach \n in {#1, #2, #3, #4, #5, #6, #7, #8, #9} {
    \edef\x{\value{col} - 0.5}
    \edef\y{9.5 - \value{row}}
    \node[anchor=center] at (\x, \y) {\n};
    \stepcounter{col}
  }
  \stepcounter{row}
}

\newcommand\setrowa[3]{
  \setcounter{cola}{1}
  \foreach \n in {#1, #2, #3} {
    \edef\x{\value{cola} - 0.5}
    \edef\y{3.5 - \value{rowa}}
    \node[anchor=center] at (\x, \y) {\n};
    \stepcounter{cola}
  }
  \stepcounter{rowa}
}
% ====================
% Body
% ====================

\begin{document}

\begin{frame}[t]
\begin{columns}[t]
\separatorcolumn

\begin{column}{\colwidth}

  \begin{block}{NP complete}


  \end{block}
  \begin{block}{Reduction}
karp reduction

   \textbf{Sudoku $\leq_p$ Latin Square $\leq_p$ Triangulate a Tripartite Graph $\leq_p$ 3-SAT $\leq_p$ SAT}

	\textbf{Def$^n$}: A valid \textbf{Sudoku} puzzle is a function $ S: i,j \rightarrow x$ for values i,j $\in \{1,...,D^2\}$ and $x \in \{0,...,D^2\}$ satisfying the following:
\begin{itemize}
	\item{for all $a,b,c$  $\in \{1,...,D^2\}$ with $S(a,b)\neq$ 0 and $S(a,c)\neq$ 0, then $ S(a,b)\neq$ S(a,c) }
	\item{for all $a,b,c$  $\in \{1,...,D^2\}$ with $S(a,b)\neq$ 0 and$ S(c,b)\neq$ 0, then $S(a,b)\neq$ S(c,b) }
	\item{for all $ a,b,c,d $ $\in \{1,...,D^2\}$ with $a\text{ mod }D = c\text{ mod }D$, $b\text{ mod }D  =  d\text{ mod }D$, $S(a,b)\neq 0$  and $S(c,d) \neq 0$, then $S(a,b)\neq S(a,c)$ }
\end{itemize}
It is completed if $x \in \{1,...,D\}$.


\textbf{Def$^n$}: A valid \textbf{Latin Square} puzzle is a function $L:i,j \rightarrow x$ for values $i,j \in \{1,..,D\} $ and $x \in \{0,...,D\}$ satisfying the following:
\begin{itemize}
\item{for all $a,b,c \in \{1,...,D\}$ with $L(a,b) \neq 0 $ and $L(a,c) \neq 0$ then $L(a,b) \neq L(a,c)$}
\item{for all $a,b,c \in \{1,...,D\}$ with $L(a,b) \neq 0 $ and $L(c,b) \neq 0$ then $L(a,b) \neq L(c,b)$}
\end{itemize}
It is complete or solved if for all $i,j \in \{1,...,D\}$, $L(i,j) \neq 0$.

\textbf{Def$^n$}: A graph $G=(V,E)$ is tripartite if a partition $V_1$, $V_2$, $V_3$ exists such that the vertices are split into three sets with no edges between vertices that belong to the same set, i.e for all $(v_i,v_j) \in E\text{ if } v_i \in V_i\text{ then }v_j \not\in V_i $.

\textbf{Def$^n$:} A \textbf{Triangulation} T of a graph G is a way to divide all edges into disjoint subsets $T_i$, each forming a triangle ($T_i=\{(v_{1}, v_{2}),(v_{2}, v_{3}),(v_{3},v_{1})\}$).

\textbf{Def$^n$:} A \textbf{boolean expression}  With a set of boolean variables $B$ and a collection of clauses $C$, with at most 3 literals (a literal is any $b \in B$ or its negation $\bar{b}$) in each, does a valid truth assignment exist that satisfies all clauses in $C$?


  \end{block}
  \begin{alertblock}{Cook Levin Theorem}
SAT is NP-complete.
  \end{alertblock}
\end{column}

\separatorcolumn

\begin{column}{\colwidth}
  \begin{block}{Sudoku $\leq_p$ Latin Square}

\textbf{Lemma:} Let $S$ be a Sudoku problem with the following construction 
\begin{equation}
	S(i,j) =\begin{cases}
0 \qquad\qquad\qquad\qquad\qquad\qquad\text{when } (i,j) \in S_l \\ 
((i-1 \text{ mod } n)n + \left\lfloor{i-1/n}\right\rfloor+j-1)\text{ mod } n^2 +1 \quad\text{otherwise}
\end{cases}
\end{equation}
where $S_l=\{(i,j)| \left\lfloor{i-1/n}\right\rfloor=0 \text{ and }(j \text{ mod }n)=1\}$. Then there exists an augmentation $S'$ to complete the sudoku puzzle if and only if the square $L$ such that $L(i,j/n)=(S'(i,j)-1)/n+1$ for all $(i,j) \in S_l$ is a Latin square.

\begin{tikzpicture}[scale=.5]

  \begin{scope}
    \draw (0, 0) grid (9, 9);
    \draw[very thick, scale=3] (0, 0) grid (3, 3);

    \setcounter{row}{1}
    \setrow {1}{2}{3}  {4}{5}{6}  {7}{8}{9}
    \setrow {4}{5}{6}  {7}{8}{9}  {1}{2}{3}
    \setrow {7}{8}{9}  {1}{2}{3}  {4}{5}{6}

    \setrow {2}{3}{4}  {5}{6}{7}  {8}{9}{1}
    \setrow {5}{6}{7}  {8}{9}{1}  {2}{3}{4}
    \setrow {8}{9}{1}  {2}{3}{4}  {5}{6}{7}

    \setrow {3}{4}{5}  {6}{7}{8}  {9}{1}{2}
    \setrow {6}{7}{8}  {9}{1}{2}  {3}{4}{5}
    \setrow {9}{1}{2}  {3}{4}{5}  {6}{7}{8}

    \node[anchor=center] at (4.5, -0.5) {S(i,j), n=3, blanks removed};
  \end{scope}

 \begin{scope}[blue, font=\sffamily\slshape]
      \setcounter{row}{1}
      \setrow {1}{ }{}  {4}{}{ }  {7}{ }{}
      \setrow {4}{}{}  {7}{}{ }  {1}{}{ }
      \setrow {7}{ }{}  {1}{ }{}  {4}{ }{}

      \setrow {}{}{ }  {}{}{}  { }{}{}
      \setrow { }{ }{}  {}{}{}  {}{ }{ }
      \setrow {}{}{ }  {}{}{}  { }{}{}

      \setrow {}{ }{}  {}{ }{}  {}{ }{}
      \setrow { }{}{}  { }{}{ }  {}{}{ }
      \setrow {}{ }{}  { }{}{ }  {}{ }{}
    \end{scope}

  \begin{scope}[xshift=12cm]
    \draw (0, 0) grid (9, 9);
    \draw[very thick, scale=3] (0, 0) grid (3, 3);

    \setcounter{row}{1}

    \setrow { }{2}{3}  { }{5}{6}  { }{8}{9}
    \setrow { }{5}{6}  { }{8}{9}  { }{2}{3}
    \setrow { }{8}{9}  { }{2}{3}  { }{5}{6}

    \setrow {2}{3}{4}  {5}{6}{7}  {8}{9}{1}
    \setrow {5}{6}{7}  {8}{9}{1}  {2}{3}{4}
    \setrow {8}{9}{1}  {2}{3}{4}  {5}{6}{7}

    \setrow {3}{4}{5}  {6}{7}{8}  {9}{1}{2}
    \setrow {6}{7}{8}  {9}{1}{2}  {3}{4}{5}
    \setrow {9}{1}{2}  {3}{4}{5}  {6}{7}{8}

    \node[anchor=center] at (4.5, -0.5) {S(i,j)};

  \end{scope}
\begin{scope}[xshift=24cm]
    \draw (0, 0) grid (3, 3);

    \setcounter{rowa}{1}

    \setrowa {1}{4}{7}
    \setrowa {4}{7}{1} 
    \setrowa {7}{1}{4} 

    \node[anchor=center] at (1.5, -0.5) {$S_l(i,j)$};

  \end{scope}
\begin{scope}[xshift=30cm]
    \draw (0, 0) grid (3, 3);

    \setcounter{rowa}{1}

    \setrowa {1}{2}{3}
    \setrowa {2}{3}{1} 
    \setrowa {3}{1}{2} 

    \node[anchor=center] at (1.5, -0.5) {L(i,j)};

  \end{scope}
\end{tikzpicture}

  \end{block}
  \begin{block}{Latin Square $\leq_p$ Triangulated Tripartite Graph}
Observe completing a partial Latin square is equivalent to triangulating tripartite graph, we map the Latin square to this through the following: 
given tripartite graph G=(V,E) label vertices in $V_1$ with distinct lables $\{r_1,...r_n\}$, label vertices in $V_2$ with distinct lables $\{c_1,...c_n\}$ and label vertices in $V_3$ with distinct lables $\{e_1,...e_n\}$. Add edges such that:
\begin{itemize}
\item{If $L(i,j) = 0$ then add the edge $(r_i,c_j)$ }
\item{If for all $i \in [0,...,n]$ and constant j, $L(i,j) \neq k$ then add the edge $(r_i,e_k)$}
\item{If for all $j \in [0,...,n]$ and constant i, $L(i,j) \neq k$ then add the edge $(c_j,e_k)$}
\end{itemize}
This graph has a triangulation iff L(i,j) can be solved.

Let us show every uniform tripartite graph is the above formulation of a Latin square.

Defn: A Latin framework LF for tripartite graph G, size (r,s,t) is a r by s array with values [1,...,t]. With constraints:
\begin{itemize}
\item{Each row/column contain each element only once.}
\item{If $(r_i,c_j)\in E$ then LF(i,j)=empty else LF(i,j)= k $k\in [1,...,t]$}
\item{If $(r_i,e_k)\in E$  then for constant i $LF(i,j)\neq k$}
\item{If $(c_i,e_k)\in E$  then for constant j $LF(i,j)\neq k$}
\end{itemize}
If r=s=t then LF is a latin square which can be completed iff G has a triangle partition.

Lemma: For graph G=(V,E) with |V|=n, there's a Latin framework of size (n,n,2n).

Define LF an n by n array. For $(r_i,c_j)\in E$ $LF(i,j)=0$ else $LF(i,j)=1+n+((i+j)mod n)$. LF is a latin framework. $\square$

Lemma: Latin framework L  (r,s,t) for uniform tripartite graph G. R(k) = the number of times k appears in L plus half $|e_k|$. Whenever $R(k)\ge r+s-t$ for $1 \le k \le t$, L can be extended to (r,s+1,t) to give L' in which $R'(k)\ge r + s+1-t$ for all $1\le k \le t$.
Lemma: Latin framework of size (r,s,s) can be extended to a Latin framework size (s,s,s).

Given a tripartite graph G, if it is not uniform then no triangulation exists, else we apply above to produce a latin framework of size (2n,2n,2n) in polynomial time. This is a Latin square which can be completed iff G has a triangulation. The latin square problem has been reduced to the triangulating a tripartite graph problem. $\square$
  \end{block}
  \begin{block}{Triangulated Tripartite Graph $\leq_p$ 3 SAT}

  \end{block}
  \begin{block}{3 SAT $\leq_p$  SAT}

Given a truth assignment $t$ check each clause is satisfied, if all are satisfied return True else False, this algorithm is at most the length of $C$ multiplied by the length of $B$. $O(BC)$ is polynomial, a polynomial verifier exists. 

Given a SAT instance with the input sets of $B$ and $C$. $C$ is in conjunctive normal form (every clause set can be converted to an equivalent set in CNF form \cite{CNF}) such that $\forall c \in C$ and for some $b_1, ... ,b_n \in B$, $c = b_1 \lor b_2 \lor ... \lor b_n$. For each $c \in C$ with more than 3 literals we can transform these to a new set of clauses of length 3. 

For $c = b_1 \lor b_2 \lor ... \lor b_n$ we introduce a new literal: $a_1$ to give $b_1 \lor b_2 \lor a_1$, $\bar{b_1} \lor a_1$, $\bar{b_2} \lor a_1$ and $a_1 \lor b_3 \lor ... \lor b_n$. Then $a_1 \lor b_3 \lor ... \lor b_n$ becomes $b_3 \lor b_4 \lor a_2$, $\bar{b_3} \lor a_2$, $\bar{b_4} \lor a_2$ and $a_1 \lor a_2 \lor b_5 \lor ... \lor b_n$. This continues at most $n/2$ times to give $a_1 \lor ... \lor a_{n/2}$ or $a_1 \lor ... \lor a_{n/2} \lor b_n$ if n is odd. 

Because we can convert a clause larger than 3 into multiple clauses of at most 3 literals in linear time ($O(n/2 + n/4 + ...) = O(n)$) this means we can reduce SAT to 3SAT in polynomial time. 

As SAT is NP-complete by the Cook-Levin Theorem, this proves 3SAT is NP-Complete. $\square$

  \end{block}
\end{column}

\separatorcolumn

\begin{column}{\colwidth}
  \begin{exampleblock}{Stochastic Methods}
  \end{exampleblock}

  \begin{block}{}
  \end{block}

  \begin{block}{References}
    \nocite{*}
    \footnotesize{\bibliographystyle{plain}\bibliography{poster}}
  \end{block}
\end{column}

\separatorcolumn
\end{columns}
\end{frame}

\end{document}